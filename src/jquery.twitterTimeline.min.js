/*
 *  Project: tweetTimeline
 *  Description: display the twitter timeline for a spe
 *  Author: Dots United GmbH
 *  License: GPL
 */
(function(c){function e(a,b){this.element=a;this.options=c.extend({},g,b);this._defaults=g;this._name=f;this.interval=null;this.init()}var f="tweetTimeline",g={username:"twitter",count:5,since_id:null,max_id:null,page:1,trim_user:!0,include_rts:!1,exclude_replies:!0,refresh:60,url:"http://api.twitter.com/1/statuses/user_timeline.json",el:"p",tweetTemplate:function(a){return a.text.parseTweet()},loader:!1,animateAdd:function(a){return a},animateRemove:function(a){a.remove()}};e.prototype.updateTweets=
function(a){var b=this;this.options.loader&&this.options.animateRemove(c(this.options.loader,this.element));c(a.reverse()).each(function(a,e){b.options.since_id=e.id_str;var d=b.options.tweetTemplate.call(b,e);b.options.el&&(d="<"+b.options.el+">"+d+"</"+b.options.el+">");c(b.element).prepend(b.options.animateAdd(c(d)));d=c(">"+b.options.el,b.element);d.size()>b.options.count&&b.options.animateRemove(d.last())})};"undefined"===typeof String.parseURL&&(String.prototype.parseURL=function(){return this.replace(/(\b(https?|ftp|file):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/ig,
function(a){return'<a href="'+a+'" target="_blank">'+a+"</a>"})});"undefined"===typeof String.parseUsername&&(String.prototype.parseUsername=function(){return this.replace(/(^|\s)@(\w+)/g,function(a){return'<a href="http://twitter.com/'+a.replace("@","")+'" target="_blank">'+a+"</a>"})});"undefined"===typeof String.parseHashtag&&(String.prototype.parseHashtag=function(){return this.replace(/(^|\s)#(\w+)/g,function(a){return'<a href="http://search.twitter.com/search?q='+a.replace("#","%23")+'" target="_blank">'+
a+"</a>"})});"undefined"===typeof String.parseTweet&&(String.prototype.parseTweet=function(){return this.parseURL().parseUsername().parseHashtag()});e.prototype.getTweets=function(){var a=this,b={screen_name:this.options.username,count:this.options.count,page:this.options.page,trim_user:this.options.trim_user,include_rts:this.options.include_rts,exclude_replies:this.options.exclude_replies};this.options.since_id&&(b=c.extend({},b,{since_id:this.options.since_id}));this.options.max_id&&(b=c.extend({},
b,{max_id:this.options.max_id}));c.ajax({url:this.options.url,crossDomain:!0,data:b,dataType:"jsonp",success:function(b,c,d){a.updateTweets.call(a,b,c,d)}})};e.prototype.init=function(){var a=this;"number"===typeof this.options.refresh&&(this.interval=setInterval(function(){a.getTweets.call(a)},1E3*this.options.refresh));this.getTweets()};c.fn[f]=function(a){return this.each(function(){c.data(this,"plugin_"+f)||c.data(this,"plugin_"+f,new e(this,a))})}})(jQuery,window,document);
